/ required locals: investigations
- paginated_objects ||= nil
.action_menu
  .action_menu_header
    .action_menu_header_left
      - if paginated_objects
        %p= page_entries_info paginated_objects, :entry_name=>top_level_container_name
        %p.paginator
          = will_paginate paginated_objects
    .action_menu_header_right
      %ul.menu
        -if current_user.has_role? "author"
          %li= link_to "create #{top_level_container_name}", new_investigation_path

- for investigation in investigations
  %div{ :id => dom_id_for(investigation), :class => 'runnable' }
    - link_text = current_user.portal_teacher || current_user.has_role?("manager", "admin") ? teacher_preview_button_for(investigation) : ""
    - link_text += preview_button_for(investigation) + name_for_component(investigation, :hide_componenent_name => true)

    = accordion_for(investigation, link_text, :investigation) do
      %div.action_menu
        %div.action_menu_header_left   
          /= link_to_container(investigation)
          %span.author
            = investigation.user.name
        %div.action_menu_header_right   
          %ul.menu
            -# %li= preview_button_for(investigation)
            -# %li= teacher_preview_button_for(investigation)
            - if (investigation.duplicateable?(current_user))
              %li.menu=link_to 'duplicate', duplicate_investigation_url(investigation)
            - if (investigation.changeable?(current_user))
              %li.menu=link_to 'edit', investigation
              %li.menu=link_to 'delete', investigation, :class => 'delete', :confirm => "Are you sure you want to delete #{top_level_container_name} #{investigation.id}", :method => :delete 
      %div{:id => dom_id_for(investigation, :details), :class => 'tiny'}
        %p=investigation.description
        %p
          %i= updated_time_text(investigation)
        %p
          %i
            Used in: #{investigation.offerings.length} classes.

  =draggable_element dom_id_for(investigation), :revert => true , :scroll => 'window'

